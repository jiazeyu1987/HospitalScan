🎯 一、项目目标

建设一个系统，实现以下功能：

（1）全国医院官网扫描

自动从“国家 → 省/自治区/直辖市 → 地市 → 区/县 → 医院” 逐级扫描。

在每个县级行政区，通过互联网检索该区域的医院官网（可基于搜索引擎、卫健委名录、医疗备案公开目录等多数据源）。

要过滤掉第三方信息聚合网站，只保留真正的医院官网。

所有医院信息以树形结构展示。

能在任意层级（省、市、县）手动新增医院。

扫描完成后的数据写入 SQLite。

下次打开系统时优先读取本地数据库，避免重复扫描。

（2）医院招投标监控

对所有医院官网进行 每 1 小时一次的自动巡检。

自动识别医院官网中的“招标采购”相关栏目。

对比本地历史记录，识别新增的招投标条目。

新发现的数据必须：
1）写入 SQLite；
2）汇总成 Excel 并导出（合并所有医院）；
3）支持用户点击单一医院手动扫描招投标；

🧱 二、系统环境与技术要求（必须满足）
后端技术

Python 3

Flask（REST API 后端）

SQLite（本地持久化）

requests（基础爬虫）

BeautifulSoup（HTML 解析）

Playwright 或 Selenium（用于 JS 渲染页面）

APScheduler（1 小时定时扫描）

pandas（数据处理）

openpyxl（Excel 导出）

logging（日志记录）

前端技术

React（或 Qt，如果你认为桌面更优，可给出两种方案）

树结构控件

简洁、干净、中文友好 UI

CRUD 表单

运行环境

单机运行

可离线工作（只要数据库已有数据）

支持 Windows、Linux

📦 三、数据来源要求（必须写清楚）

LLM 必须详细设计数据采集渠道，例如：

1. 行政区划数据来源

使用公开的行政区划 JSON、CSV 或从民政部/统计局等公开目录获取

或者在项目初始化时导入预置地区树

必须描述地区树的格式、存储结构、加载方式

2. 医院官网数据来源（多渠道交叉验证）

LLM 必须输出用于医院官网识别的数据源：

搜索引擎 API / 普通搜索 HTML（如“××县 医院 官网”）

卫健委或政府办公开的医院名录

备案/公示/法人信息网站作为辅助验证

并要求给出：

去重策略

医院官网真实性判定规则

反爬限制处理方式

数据回溯机制

🧩 四、数据库结构要求（必须非常详细）

LLM 必须输出：

1. 全部表

（每个表包括字段名、类型、含义、约束、索引）

必含：

regions（行政区划）

hospitals（医院）

hospital_alias（可选，用于多名称匹配）

tender_records（招投标记录）

tender_raw_html（可选，保存原始抓取）

scan_history（扫描日志）

settings（系统配置）

2. 关系图

必须输出 ER 图或文字版关系结构。

3. 数据索引设计

例如：

index on hospitals.region_id

index on tender_records.content_hash

🔍 五、爬虫系统要求（必须非常详细）

LLM 必须输出整个爬虫架构，包括：

1. 行政区划扫描流程

详细说明如何从省 → 市 → 县 → 医院逐级检索。

2. 官网识别算法

必须包含多个策略，例如：

通过搜索引擎结果抓取

关键字段匹配（“医院”“医疗”“人民医院”）

主页识别（要求包含医院名称、科室、联系方式）

排除目录页（如“xx114、xx网、xx大全”）

域名可信度规则（gov.cn、org.cn 优先）

多页面比对确认

3. 招投标栏目识别

必须给出各种可能的栏目：
公告 / 招标 / 采购 / 公示 / 信息公开 / 新闻栏目中的子栏目等。

同时必须给出：

如何自动发现栏目

如何处理分页

如何提取标题、正文、发布日期

如何处理无法获取发布日期的情况

4. 去重与增量更新机制

必须写出：

content_hash 计算方法

通过 URL + 标题 + 日期 做组合判断

旧数据比对策略

5. 反爬策略

必须包含：

并发限制

随机 UA

IP 轮换（可选）

遇到验证码的处理建议

请求重试与回退策略

🕒 六、调度系统要求

LLM 必须输出定时扫描系统设计，包括：

APScheduler 使用方式

1 小时执行一次

从第一家医院扫描到最后一家医院

扫描队列机制

错误恢复、失败重试

停止/启动定时任务的接口设计

🖥 七、前端 UI 要求（必须详细）

LLM 必须输出 UI 结构：

左侧：树形行政区 + 医院

支持展开/折叠

节点右键菜单（新增、编辑、删除）

右侧：医院详情

名称

官网 URL

上次扫描时间

手动“扫描招投标”按钮

招投标历史列表（分页）

顶部工具栏：

“全量扫描医院”

“导出招投标 Excel”

“启动/停止定时扫描”

“设置”（扫描周期、代理、UA）

📄 八、Excel 导出规范（必须写清楚）

LLM 必须输出 Excel 结构：

Sheet 名称

字段顺序（医院名称、省、市、县、公告标题、发布日期、URL、正文摘要等）

字段类型

日期格式

排序规则（按时间倒序）

⚠ 九、错误处理与稳定性要求

必须输出：

网络错误重试策略

HTML 结构变化检测

日志结构（error/info/debug）

数据一致性校验

稳定性建议（例如缓存医院页面结构等）

🔧 十、可扩展性

LLM 必须输出未来可扩展方向，例如：

多国医院支持

招投标智能分类

AI 自动解析 PDF 招标文书

分布式扫描

使用消息队列（如 Redis)

📝 十一、最终输出格式要求

请严格按照以下格式输出：

系统架构总览（含逻辑图）

数据库结构（含字段、类型、索引、外键）

核心流程图（行政区扫描、医院识别、招投标扫描）

后端架构

前端架构

API 列表（定义明确）

爬虫细节与反爬策略

定时任务设计

Excel 导出格式

错误处理机制

安全与合规性

性能优化建议

扩展能力建议

要求条理清晰、结构完整、技术可行、可直接进入开发阶段。

🚨 关键问题与建议调整
1. 法律与合规风险 ⚠️

批量爬取医院官网可能违反网站服务条款
1小时全量扫描可能被视为攻击行为
建议:

增加 robots.txt 检查
扫描频率可以设置(建议4-6小时)
增加User-Agent声明
添加"仅用于科研/个人学习"免责声明



2. 技术可行性问题

医院官网识别准确率可能很低(很多医院无独立官网)
招投标栏目结构差异极大,自动识别成功率可能<50%
Playwright/Selenium 会极大增加资源消耗
建议:

采用"半自动+人工校验"模式
提供"自定义规则"功能
使用轻量级方案优先(requests),复杂方案使用Playwright



3. 数据源问题

你没有明确行政区划数据从哪来
建议:

使用国家统计局公开数据
集成免费的DuckDuckGo搜索
提供手动导入医院列表功能



✅ 优化后的技术方案
我将基于你的需求,给出更务实、可落地的完整设计:
核心调整:

✅ 保留SQLite,但设计可迁移架构
✅ 扫描频率改为可配置(默认6小时)
✅ 增加"手动校验+规则学习"机制
✅ 增强错误处理和增量更新
✅ 明确所有数据源获取方式



┌─────────────────────────────────────────────────────────┐
│                    前端层 (Frontend)                      │
├─────────────────────────────────────────────────────────┤
│  ┌──────────────┐              ┌──────────────┐         │
│  │  React Web   │              │  PyQt Desktop │         │
│  │  (推荐方案)   │              │  (备选方案)    │         │
│  └──────────────┘              └──────────────┘         │
└─────────────────────────────────────────────────────────┘
                         ↕ REST API
┌─────────────────────────────────────────────────────────┐
│                    后端层 (Backend)                       │
├─────────────────────────────────────────────────────────┤
│  Flask API Server                                        │
│  ├─ 医院管理模块 (HospitalService)                        │
│  ├─ 爬虫引擎模块 (CrawlerEngine)                          │
│  ├─ 调度模块 (SchedulerService)                          │
│  ├─ 导出模块 (ExportService)                             │
│  └─ 配置模块 (ConfigService)                             │
└─────────────────────────────────────────────────────────┘
                         ↕
┌─────────────────────────────────────────────────────────┐
│                  数据层 (Data Layer)                      │
├─────────────────────────────────────────────────────────┤
│  SQLAlchemy ORM                                          │
│  └─ SQLite Database (可升级为PostgreSQL)                 │
└─────────────────────────────────────────────────────────┘
                         ↕
┌─────────────────────────────────────────────────────────┐
│                 外部数据源 (Data Sources)                 │
├─────────────────────────────────────────────────────────┤
│  ├─ 国家统计局行政区划数据                                 │
│  ├─ DuckDuckGo搜索API (免费)                              │
│  ├─ 卫健委公开医院名录 (手动导入)                          │
│  └─ 医院官网 (爬虫目标)                                    │
└─────────────────────────────────────────────────────────┘